{% extends "base.html" %}

{% block content %}
<div class="container">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
        <h1 style="border-bottom: 3px solid #ff9800; padding-bottom: 5px;">
            ğŸ° Clan: {{ clan.name }}
        </h1>
        <a href="{{ url_for('auth.logout') }}" class="btn-small" style="background: #d32f2f;">Abmelden</a>
    </div>

    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
        
        <div>
            <h3 style="color: #4caf50;">âœ… Unsere Teams</h3>
            <div class="card" style="min-height: 200px;">
                {% if clan.members %}
                    <ul style="list-style: none; padding: 0;">
                        {% for member in clan.members %}
                        <li style="background: #222; padding: 15px; margin-bottom: 10px; border-radius: 4px; border: 1px solid #333;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                                <span style="font-weight: bold; font-size: 1.1em;">{{ member.username }}</span>
                                <form action="{{ url_for('main.clan_remove_member', user_id=member.id) }}" method="POST" onsubmit="return confirm('Team wirklich aus dem Clan werfen?');">
                                    <button type="submit" class="btn-small" style="background: #d32f2f; padding: 2px 8px; font-size: 0.8rem;">Entfernen</button>
                                </form>
                            </div>
                            <div style="font-size: 0.9em; color: #aaa;">
                                Token: <code style="color: #4caf50; background: #111; padding: 2px 5px; border-radius: 3px;">{{ member.token }}</code>
                            </div>
                        </li>
                        {% endfor %}
                    </ul>
                {% else %}
                    <p style="color: #aaa; font-style: italic; padding: 20px; text-align: center;">
                        Noch keine Teams erstellt. <br>Nutze das Formular rechts ğŸ‘‰
                    </p>
                {% endif %}
            </div>
        </div>

        <div>
            <h3 style="color: #2196f3;">âš¡ Team Management</h3>
            <div class="card" style="margin-bottom: 30px;">
                <h4 style="margin-top: 0; border-bottom: 1px solid #444; padding-bottom: 10px; margin-bottom: 15px;">ğŸ†• Neues Team erstellen</h4>
                <form action="{{ url_for('main.clan_create_team') }}" method="POST" style="display: flex; gap: 10px; margin-bottom: 20px;">
                    <input type="text" name="team_name" placeholder="Team Name" required 
                           style="flex: 1; padding: 10px; background: #1a1a1a; border: 1px solid #444; color: white; border-radius: 4px;">
                    <button type="submit" class="btn" style="background: #2196f3;">Erstellen</button>
                </form>
                
                <hr style="border-color: #333; margin: 20px 0;">
                
                <h4 style="color: #aaa; font-size: 0.9rem; text-transform: uppercase;">Oder freie Teams aufnehmen:</h4>
                {% if free_agents %}
                    <ul style="list-style: none; padding: 0;">
                        {% for agent in free_agents %}
                        <li style="background: #1a1a1a; padding: 10px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center; border: 1px dashed #444; border-radius: 4px;">
                            <span>{{ agent.username }}</span>
                            <form action="{{ url_for('main.clan_add_member', user_id=agent.id) }}" method="POST">
                                <button type="submit" class="btn-small" style="background: #555;">HinzufÃ¼gen</button>
                            </form>
                        </li>
                        {% endfor %}
                    </ul>
                {% else %}
                    <p style="color: #666; font-style: italic; font-size: 0.9em;">Momentan keine clanlosen Teams verfÃ¼gbar.</p>
                {% endif %}
            </div>

            <h3 style="color: #aaa;">âš™ï¸ Einstellungen</h3>
            <div class="card" style="border-top: 4px solid #aaa;">
                <h4 style="margin-top: 0;">Passwort Ã¤ndern</h4>
                <form action="{{ url_for('main.clan_change_password') }}" method="POST">
                    <input type="password" name="current_password" placeholder="Aktuelles Passwort" required style="width: 100%; padding: 10px; margin-bottom: 10px; background: #1a1a1a; border: 1px solid #444; color: white; border-radius: 4px;">
                    <input type="password" name="new_password" placeholder="Neues Passwort" required style="width: 100%; padding: 10px; margin-bottom: 10px; background: #1a1a1a; border: 1px solid #444; color: white; border-radius: 4px;">
                    <input type="password" name="confirm_password" placeholder="Passwort bestÃ¤tigen" required style="width: 100%; padding: 10px; margin-bottom: 15px; background: #1a1a1a; border: 1px solid #444; color: white; border-radius: 4px;">
                    <button type="submit" class="btn" style="background: #555; width: 100%;">Passwort speichern</button>
                </form>
            </div>
        </div>

    </div>
</div>
{% endblock %}